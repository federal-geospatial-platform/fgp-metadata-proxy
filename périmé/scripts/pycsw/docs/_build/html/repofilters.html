<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Repository Filters &mdash; pycsw 2.2.0 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="pycsw 2.2.0 documentation" href="index.html" />
    <link rel="next" title="Profile Plugins" href="profiles.html" />
    <link rel="prev" title="Transactions" href="transactions.html" />
 

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-32855587-1']);
  _gaq.push(['_setDomainName', 'pycsw.org']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>


  </head>
  <body role="document">

<style type="text/css">
  .header a:link{color: white;}
  .header a:visited{color: white;}
  .padded{padding: 10px 10px;}
</style>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="profiles.html" title="Profile Plugins"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="transactions.html" title="Transactions"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pycsw 2.2.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="repository-filters">
<span id="repofilters"></span><h1>Repository Filters<a class="headerlink" href="#repository-filters" title="Permalink to this headline">¶</a></h1>
<p>pycsw has the ability to perform server side repository / database filters as a means to mask all CSW requests to query against a specific subset of the metadata repository, thus providing the ability to deploy multiple pycsw instances pointing to the same database in different ways via the <code class="docutils literal"><span class="pre">repository.filter</span></code> configuration option.</p>
<p>Repository filters are a convenient way to subset your repository at the server level without the hassle of creating proper database views.  For large repositories, it may be better to subset at the database level for performance.</p>
<div class="section" id="scenario-one-database-many-views">
<h2>Scenario: One Database, Many Views<a class="headerlink" href="#scenario-one-database-many-views" title="Permalink to this headline">¶</a></h2>
<p>Imagine a sample database table of records (subset below for brevity):</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">identifier</th>
<th class="head">parentidentifier</th>
<th class="head">title</th>
<th class="head">abstract</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>33</td>
<td>foo1</td>
<td>bar1</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>33</td>
<td>foo2</td>
<td>bar2</td>
</tr>
<tr class="row-even"><td>3</td>
<td>55</td>
<td>foo3</td>
<td>bar3</td>
</tr>
<tr class="row-odd"><td>4</td>
<td>55</td>
<td>foo1</td>
<td>bar1</td>
</tr>
<tr class="row-even"><td>5</td>
<td>21</td>
<td>foo5</td>
<td>bar5</td>
</tr>
<tr class="row-odd"><td>5</td>
<td>21</td>
<td>foo6</td>
<td>bar6</td>
</tr>
</tbody>
</table>
<p>A default pycsw instance (with no <code class="docutils literal"><span class="pre">repository.filters</span></code> option) will always process CSW requests against the entire table.  So a CSW <cite>GetRecords</cite> filter like:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;ogc:Filter&gt;</span>
    <span class="nt">&lt;ogc:PropertyIsEqualTo&gt;</span>
        <span class="nt">&lt;ogc:PropertyName&gt;</span>apiso:Title<span class="nt">&lt;/ogc:PropertyName&gt;</span>
        <span class="nt">&lt;ogc:Literal&gt;</span>foo1<span class="nt">&lt;/ogc:Literal&gt;</span>
    <span class="nt">&lt;/ogc:PropertyIsEqualTo&gt;</span>
<span class="nt">&lt;/ogc:Filter&gt;</span>
</pre></div>
</div>
<p>...will return:</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">identifier</th>
<th class="head">parentidentifier</th>
<th class="head">title</th>
<th class="head">abstract</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>33</td>
<td>foo1</td>
<td>bar1</td>
</tr>
<tr class="row-odd"><td>4</td>
<td>55</td>
<td>foo1</td>
<td>bar1</td>
</tr>
</tbody>
</table>
<p>Suppose you wanted to deploy another pycsw instance which serves metadata from the same database, but only from a specific subset.  Here we set the <code class="docutils literal"><span class="pre">repository.filter</span></code> option:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>[repository]
database=sqlite:///records.db
filter=pycsw:ParentIdentifier = &#39;33&#39;
</pre></div>
</div>
<p>The same CSW <cite>GetRecords</cite> filter as per above then yields the following results:</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">identifier</th>
<th class="head">parentidentifier</th>
<th class="head">title</th>
<th class="head">abstract</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>33</td>
<td>foo1</td>
<td>bar1</td>
</tr>
</tbody>
</table>
<p>Another example:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>[repository]
database=sqlite:///records.db
filter=pycsw:ParentIdentifier != &#39;33&#39;
</pre></div>
</div>
<p>The same CSW <cite>GetRecords</cite> filter as per above then yields the following results:</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">identifier</th>
<th class="head">parentidentifier</th>
<th class="head">title</th>
<th class="head">abstract</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>4</td>
<td>55</td>
<td>foo1</td>
<td>bar1</td>
</tr>
</tbody>
</table>
<p>The <code class="docutils literal"><span class="pre">repository.filter</span></code> option accepts all core queryables set in the pycsw core model (see <code class="docutils literal"><span class="pre">pycsw.config.StaticContext.md_core_model</span></code> for the complete list).</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Repository Filters</a><ul>
<li><a class="reference internal" href="#scenario-one-database-many-views">Scenario: One Database, Many Views</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="transactions.html"
                        title="previous chapter">Transactions</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="profiles.html"
                        title="next chapter">Profile Plugins</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/repofilters.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div><p>
    <a title="This product conforms to the OpenGIS Catalogue Service Implementation Specification [Catalogue Service for the Web], Revision 3.0.0. OGC, OGC®, and CERTIFIED OGC COMPLIANT are trademarks or registered trademarks of the Open Geospatial Consortium, Inc. in the United States and other countries." href="http://www.opengeospatial.org/resource/products/details/?pid=1374"><img alt="This product conforms to the OpenGIS Catalogue Service Implementation Specification [Catalogue Service for the Web], Revision 3.0.0. OGC, OGC®, and CERTIFIED OGC COMPLIANT are trademarks or registered trademarks of the Open Geospatial Consortium, Inc. in the United States and other countries." src="https://portal.opengeospatial.org/public_ogc/compliance/Certified_OGC_Compliant_Logo_Web.gif" height="74"/></a>
</p>

<p>
    <a title="This product conforms to the OpenGIS Catalogue Service Implementation Specification [Catalogue Service for the Web], Revision 3.0.0. OGC, OGC®, and CERTIFIED OGC COMPLIANT are trademarks or registered trademarks of the Open Geospatial Consortium, Inc. in the United States and other countries." href="http://www.opengeospatial.org/resource/products/details/?pid=1374"><img alt="This product conforms to the OpenGIS Catalogue Service Implementation Specification [Catalogue Service for the Web], Revision 3.0.0. OGC, OGC®, and CERTIFIED OGC COMPLIANT are trademarks or registered trademarks of the Open Geospatial Consortium, Inc. in the United States and other countries." src="https://portal.opengeospatial.org/public_ogc/compliance/badge.php?s=CAT%20CSW%203.0.0&r=1" height="38"/></a>
</p>

<p>
    <a title="This product conforms to the OpenGIS Catalogue Service Implementation Specification [Catalogue Service for the Web], Revision 2.0.2. OGC, OGC®, and CERTIFIED OGC COMPLIANT are trademarks or registered trademarks of the Open Geospatial Consortium, Inc. in the United States and other countries." href="http://www.opengeospatial.org/resource/products/details/?pid=1374"><img alt="This product conforms to the OpenGIS Catalogue Service Implementation Specification [Catalogue Service for the Web], Revision 2.0.2. OGC, OGC®, and CERTIFIED OGC COMPLIANT are trademarks or registered trademarks of the Open Geospatial Consortium, Inc. in the United States and other countries." src="https://portal.opengeospatial.org/public_ogc/compliance/badge.php?s=CAT%20CSW%202.0.2&r=1" height="38"/></a>
</p>

<p>
    <img alt="OSGeo Project" src="https://raw.githubusercontent.com/OSGeo/osgeo/master/incubation/project/OSGeo_project.png" height="64"/>
</p>

<p>
    <script type="text/javascript" src="https://www.openhub.net/p/488022/widgets/project_thin_badge.js"></script> 
</p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="profiles.html" title="Profile Plugins"
             >next</a></li>
        <li class="right" >
          <a href="transactions.html" title="Transactions"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pycsw 2.2.0 documentation</a> &raquo;</li> 
      </ul>
    </div>

<div class="footer">
    <p>&copy; Copyright 2010-2015, Tom Kralidis This work is licensed under a Creative Commons Attribution 4.0 International License<br/>Last updated on 2018-03-20T12:16:33Z</p>
    <p>
        <a href="http://pycsw.org">Website</a> &mdash;
        <a href="http://pycsw.org/community">Community</a> &mdash;
        <a href="http://pycsw.org/blog">Blog</a> &mdash;
        <a href="https://plus.google.com/communities/104084873011085696113">Google+</a> &mdash;
        <a href="http://pycsw.org/download">Download</a> &mdash;
        <a href="https://github.com/geopython/pycsw">Source</a> &mdash;
        <a href="https://github.com/geopython/pycsw/issues">Issues</a> &mdash;
        <a href="http://lists.osgeo.org/mailman/listinfo/pycsw-devel">Mailing List</a>
    </p>
</div>

  </body>
</html>